<script type="text/javascript" language="JavaScript">
    $('.fieldList').on('change', '.optionLoader', function () {
        var id = $(this).attr('id');
        var label = $('#' + id + ' option:selected').text();
        var name = $(this).attr('name');

        id = id.replace('destination', 'options');

        if (label == 'phoneNumber (Phone)') {
            name = name.replace('destination', 'option');
            var content = '{% include '@BusybeePhone/Phone/optionPhoneNumber.html.twig' %}';
            content = content.replace(/__id__/g, id.replace('options', 'option'));
            content = content.replace('__name__', name);
            $("#" + id).html(content);
            $("#" + id).show();
        }
        else if (label == 'dob (Person)') {
            name = name.replace('destination', 'option');
            var content = '{% include '@BusybeePerson/People/optionDoB.html.twig' %}';
            content = content.replace(/__id__/g, id.replace('options', 'option'));
            content = content.replace('__name__', name);
            $("#" + id).html(content);
            $("#" + id).show();
        }
        else {
            $("#" + id).hide(1000);
            $("#" + id).html('&nbsp;');
        }
    });

    $(".fieldList").collection({
        name_prefix: '{{ form.fields.vars.full_name }}',
        allow_up: false,
        allow_down: false,
        add: '{{ addButton({title: 'people.matchimport.button.add', transDomain: 'BusybeePersonBundle', mergeClass: 'collection-rescue-add collection-action', colour: 'primary'})|raw }}',
        remove: '{{ deleteButton({title: 'people.matchimport.button.remove', transDomain: 'BusybeePersonBundle', mergeClass: 'collection-remove collection-action', colour: 'warning'})|raw }}',
        add_at_the_end: true
    });
</script>