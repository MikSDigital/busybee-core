{# src/Busybee/PaginationBundle/Resources/views/Default/index.html.twig #}

{% trans_default_domain 'BusybeePaginationBundle' %}

{% set form = pagination.getForm %}

{% form_theme form 'bootstrap_3_horizontal_layout.html.twig' %}

{% if form_array is not defined %}
    {% set form_array = [] %}
{% endif %}
{% set form_array = form_array|merge({'attr': {'id': 'paginator'}}) %}

{{ form_start(form, form_array) }}
<div class="container-fluid well">
    <div class="row">
        <div class="col-sm-3">
            <div class="input-group">
                {{ form_widget(form.currentSearch) }}
                <div class="input-group-btn">
                    <button class="btn btn-success halflings halflings-search" type="submit"
                            name="paginator[startSearch]"
                            id="paginator_startSearch" style="height: 34px; margin-top: -1px; ">
                    </button>
                </div>
            </div>
        </div>
        <div class="col-sm-3">
            {{ form_widget(form.currentSort) }}
        </div>
        {% if pagination.getTotal > pagination.getLimit %}
            <div class="col-sm-offset-4 col-sm-2">
                {{ form_widget(form.lastSearch, {value: pagination.getSearch }) }}
                {{ form_widget(form.offSet, {value: pagination.getOffSet}) }}
                <div class="input-group">
                    <div class="input-group-btn">
                        {{ saveButton({'class': 'btn btn-info halflings halflings-backward', 'additional': 'id="paginator_prev"', 'style': 'height: 34px; margin-top: -1px;'})|raw }}
                    </div>
                    {{ form_widget(form.limit, {'value': '' ~ pagination.limit}) }}
                    <div class="input-group-btn">
                        {{ saveButton({'class': 'btn btn-info halflings halflings-forward', 'additional': 'id="paginator_next"', 'style': 'height: 34px; margin-top: -1px;'})|raw }}
                    </div>
                </div>
                {{ form_widget(form.total, {value: pagination.getTotal}) }}
            </div>
        {% elseif pagination.getTotal > 10 %}
            <div class="col-sm-offset-4 col-sm-2">
                {{ form_widget(form.limit, {'value': '' ~ pagination.limit}) }}
            </div>
        {% else %}
            {% do form.limit.setRendered %}
            <input type="hidden" name="paginator[limit]" id="paginator_limit" value="{{ pagination.limit }}"/>
        {% endif %}
    </div>
    <div class="row">
        <div class="col-sm-6">
            {% if pagination.choice is defined %}
                <div>
                    {% for name,choice in pagination.choice %}
                        {% set title = 'people.choice.' ~ name ~ '.title' %}
                        {% set label = 'people.choice.' ~ name ~ '.label' %}

                        {% set title = title|trans %}
                        {% set label = label|trans %}

                        {% set values = app.request.get('paginator') %}

                        {% if values['choice'] is defined %}
                            {% set values = values['choice'] %}
                        {% else %}
                            {% set values = {'all': 'on'} %}
                        {% endif %}

                        {% set toggle = 'data-toggle=toggle data-onstyle=success data-offstyle=warning data-height=25 data-size=small data-on="' ~ label ~ '" data-off="' ~ label ~ '"' %}
                        {% set checked = '' %}
                        {% if values[name] is defined %}
                            {% set checked = 'checked' %}
                        {% endif %}
                        <label class="checkbox-inline">
                            <input type="checkbox" name="paginator[choice][{{ name }}]"
                                   id="pagination_choice_{{ name }}"
                                   title="{{ title }}"
                                   class="choice{{ name }}Toggle paginationChoice" {{ toggle|raw }} {{ checked }} />
                        </label>
                    {% endfor %}
                </div>

            {% endif %}
        </div>
        <div class="col-sm-6 text-right">
            {% set pages = pagination.getTotalPages %}

            {% transchoice pages with {'%total%': pagination.getTotal, '%current%': pagination.getCurrentPage, '%pages%': pages, '%first%': pagination.getFirstRecord, '%last%': pagination.getLastRecord} %}
            pagination.figures
            {% endtranschoice %}
        </div>
    </div>
</div>
{{ form_end(form) }}
